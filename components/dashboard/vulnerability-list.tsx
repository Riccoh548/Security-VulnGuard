import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card"
import { Badge } from "@/components/ui/badge"
import { Button } from "@/components/ui/button"
import { AlertTriangle, XCircle, AlertCircle, Info, Brain, ExternalLink, Clock } from "lucide-react"

export function VulnerabilityList() {
  const vulnerabilities = [
    {
      id: "CVE-2024-0001",
      title: "SQL Injection in User Authentication",
      severity: "Critical",
      score: 9.8,
      category: "Web Application",
      aiSummary:
        "AI detected this vulnerability allows complete database access through login form. Immediate patching required.",
      remediation: "Update authentication module to v2.1.3",
      affected: "login.php, auth.js",
      discovered: "2 hours ago",
      icon: XCircle,
      color: "text-red-600",
      bgColor: "bg-red-50",
      borderColor: "border-red-200",
    },
    {
      id: "CVE-2024-0002",
      title: "Unencrypted Data Transmission",
      severity: "High",
      score: 7.5,
      category: "Network",
      aiSummary: "AI analysis shows sensitive data transmitted over HTTP. SSL/TLS implementation recommended.",
      remediation: "Configure HTTPS with valid SSL certificate",
      affected: "api.example.com",
      discovered: "4 hours ago",
      icon: AlertTriangle,
      color: "text-orange-600",
      bgColor: "bg-orange-50",
      borderColor: "border-orange-200",
    },
    {
      id: "CVE-2024-0003",
      title: "Outdated JavaScript Libraries",
      severity: "Medium",
      score: 5.3,
      category: "Dependencies",
      aiSummary: "AI identified 3 outdated libraries with known vulnerabilities. Update recommended.",
      remediation: "npm update && npm audit fix",
      affected: "package.json",
      discovered: "1 day ago",
      icon: AlertCircle,
      color: "text-yellow-600",
      bgColor: "bg-yellow-50",
      borderColor: "border-yellow-200",
    },
    {
      id: "INFO-2024-0001",
      title: "Missing Security Headers",
      severity: "Low",
      score: 3.1,
      category: "Configuration",
      aiSummary: "AI recommends adding security headers for defense in depth.",
      remediation: "Configure CSP, HSTS, and X-Frame-Options headers",
      affected: "Web server configuration",
      discovered: "2 days ago",
      icon: Info,
      color: "text-blue-600",
      bgColor: "bg-blue-50",
      borderColor: "border-blue-200",
    },
  ]

  const getSeverityBadge = (severity: string) => {
    const colors = {
      Critical: "bg-red-100 text-red-700 border-red-200",
      High: "bg-orange-100 text-orange-700 border-orange-200",
      Medium: "bg-yellow-100 text-yellow-700 border-yellow-200",
      Low: "bg-blue-100 text-blue-700 border-blue-200",
    }
    return colors[severity as keyof typeof colors] || colors.Low
  }

  return (
    <div className="space-y-6">
      <div className="flex items-center justify-between">
        <h2 className="text-2xl font-bold">AI-Analyzed Vulnerabilities</h2>
        <Badge className="bg-purple-100 text-purple-700 border-purple-200">
          <Brain className="w-3 h-3 mr-1" />
          AI Classified
        </Badge>
      </div>

      <div className="space-y-4">
        {vulnerabilities.map((vuln, index) => (
          <Card key={index} className={`border-l-4 ${vuln.borderColor} hover:shadow-lg transition-shadow`}>
            <CardHeader className="pb-4">
              <div className="flex items-start justify-between">
                <div className="flex items-start space-x-3">
                  <div className={`p-2 rounded-lg ${vuln.bgColor}`}>
                    <vuln.icon className={`w-5 h-5 ${vuln.color}`} />
                  </div>
                  <div className="space-y-1">
                    <div className="flex items-center space-x-2">
                      <CardTitle className="text-lg">{vuln.title}</CardTitle>
                      <Badge variant="outline" className="text-xs">
                        {vuln.id}
                      </Badge>
                    </div>
                    <div className="flex items-center space-x-4 text-sm text-gray-500">
                      <span className="flex items-center">
                        <Clock className="w-3 h-3 mr-1" />
                        {vuln.discovered}
                      </span>
                      <span>Score: {vuln.score}</span>
                      <span>{vuln.category}</span>
                    </div>
                  </div>
                </div>
                <Badge className={getSeverityBadge(vuln.severity)}>{vuln.severity}</Badge>
              </div>
            </CardHeader>

            <CardContent className="space-y-4">
              <div className="bg-purple-50 border border-purple-200 rounded-lg p-3">
                <div className="flex items-start space-x-2">
                  <Brain className="w-4 h-4 text-purple-600 mt-0.5" />
                  <div>
                    <p className="text-sm font-medium text-purple-800 mb-1">AI Analysis</p>
                    <p className="text-sm text-purple-700">{vuln.aiSummary}</p>
                  </div>
                </div>
              </div>

              <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <p className="text-sm font-medium text-gray-700 mb-1">Recommended Action</p>
                  <p className="text-sm text-gray-600">{vuln.remediation}</p>
                </div>
                <div>
                  <p className="text-sm font-medium text-gray-700 mb-1">Affected Components</p>
                  <p className="text-sm text-gray-600">{vuln.affected}</p>
                </div>
              </div>

              <div className="flex items-center justify-between pt-2">
                <Button variant="outline" size="sm">
                  View Details
                  <ExternalLink className="w-3 h-3 ml-1" />
                </Button>
                <div className="flex space-x-2">
                  <Button variant="outline" size="sm">
                    Mark as False Positive
                  </Button>
                  <Button size="sm" className="bg-blue-600 hover:bg-blue-700">
                    Start Remediation
                  </Button>
                </div>
              </div>
            </CardContent>
          </Card>
        ))}
      </div>
    </div>
  )
}
